{"version":3,"sources":["login.js"],"names":["DomHelper","checkEl","el","document","getElementById","AddClass","className","classList","contains","add","RemoveClass","remove","ClearHTML","innerHTML","AppendHTML","addition","InnerHTML","value","this","undefined","AlertFactory","GenerateAlert","container","type","CreateAlert","message","GenerateDangerAlert","data","GenerateSuccessAlert","HttpHelper","callEndpoint","endpoint","method","callback","request","XMLHttpRequest","onload","readyState","DONE","status","responseText","open","send","UNPROCESSABLE_ENTITY","OK","CREATED","Get","calback","Post","UrlHelper","Redirect","url","delay","setTimeout","window","location","addEventListener","event","preventDefault","LoginController","Login","getAttribute","ValidateLoginData","username","password","LoginCallback","JSON","parse","forEach","Object","keys","redirect_url","source","form","elements","FormData"],"mappings":"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","file":"login.js","sourcesContent":["(function (DomHelper) {\n\n  DomHelper.AddClass = function (el, className) {\n\n    el = checkEl(el);\n    if (!el.classList.contains(className)) {\n      el.classList.add(className);\n    }\n  }\n\n  DomHelper.RemoveClass = function (el, className) {\n\n    el = checkEl(el);\n    if (el.classList.contains(className)) {\n      el.classList.remove(className);\n    }\n  }\n\n  DomHelper.ClearHTML = function (el) {\n\n    el = checkEl(el);\n    el.innerHTML = \"\";\n  }\n\n  DomHelper.AppendHTML = function (el, addition) {\n\n    el = checkEl(el);\n    el.innerHTML = el.innerHTML + addition;\n  }\n\n  DomHelper.InnerHTML = function (el, value) {\n\n    el = checkEl(el);\n\n    DomHelper.ClearHTML(el);\n    DomHelper.AppendHTML(el, value);\n  }\n\n  function checkEl(el) {\n    return (typeof el == 'string') ? document.getElementById(el) : el;\n  }\n\n})(this.DomHelper = (this.DomHelper == undefined) ? {} : this.DomHelper);\n\n(function (DomHelper, AlertFactory) {\n\n  AlertFactory.GenerateDangerAlert = function (container, data) {\n    GenerateAlert(container, data, \"alert-danger\");\n  }\n\n  AlertFactory.GenerateSuccessAlert = function (container, data) {\n    GenerateAlert(container, data, \"alert-success\");\n  }\n\n  function GenerateAlert(container, value, type) {\n    DomHelper.AppendHTML(container, CreateAlert(value, type));\n  }\n\n  function CreateAlert(message, type) {\n    return \"<div class='alert \" + type + \"'>\" + message + \"</div>\";\n  }\n\n})(\n  DomHelper,\n  this.AlertFactory = (this.AlertFactory == undefined) ? {} : this.AlertFactory\n  );\n(function (HttpHelper) {\n\n  HttpHelper.UNPROCESSABLE_ENTITY = 422;\n  HttpHelper.OK = 200;\n  HttpHelper.CREATED = 201;\n\n  HttpHelper.Get = function (endpoint, calback) {\n    callEndpoint(endpoint, \"GET\", \"\", callback);\n  }\n\n  HttpHelper.Post = function (endpoint, data, callback) {\n    callEndpoint(endpoint, \"POST\", data, callback);\n  }\n\n  function callEndpoint(endpoint, method, data, callback) {\n    var request = new XMLHttpRequest();\n\n    request.onload = function () {\n      if (request.readyState == XMLHttpRequest.DONE) {\n        callback(request.status, request.responseText);\n      }\n    }\n    request.open(method, endpoint);\n    request.send(data);\n  }\n\n})(this.HttpHelper = (this.HttpHelper == undefined) ? {} : this.HttpHelper);\n\n(function (UrlHelper) {\n\n  UrlHelper.Redirect = function (url, delay) {\n    setTimeout(function () {\n      window.location = url;\n    }, delay);\n  }\n\n})(this.UrlHelper = (this.UrlHelper == undefined) ? {} : this.UrlHelper);\n\n{\n  document\n    .getElementById(\"login-form\")\n    .addEventListener(\"submit\", function (event) {\n      event.preventDefault();\n      LoginController.Login(this.getAttribute(\"data-source\"));\n    });\n}\n\n(function (DomHelper, AlertFactory, HttpHelper, UrlHelper, LoginController) {\n\n  LoginController.Login = function (source) {\n\n    var form = document.getElementById(\"login-form\");\n    var username = form.elements[\"username\"].value;\n    var password = form.elements[\"password\"].value;\n\n    if (ValidateLoginData(username, password)) {\n\n      var endpoint = source + \"action/login\";\n      var data = new FormData(form);\n\n      HttpHelper.Post(endpoint, data, LoginCallback);\n    }\n  }\n\n  function ValidateLoginData(username, password) {\n\n    // TODO: Validate the username and password semantics-wise\n\n    return true;\n  }\n\n  function LoginCallback(status, responseText) {\n\n    var data = JSON.parse(responseText);\n    var container = document.getElementById(\"notifications\");\n\n    DomHelper.ClearHTML(container);\n\n    if (status == HttpHelper.UNPROCESSABLE_ENTITY) {\n\n      AlertFactory.GenerateDangerAlert(\n        container, \"Could not log in. Please check validation errors.\"\n      );\n\n      [\"username\", \"password\"].forEach(function (value) {\n        DomHelper.RemoveClass(value, \"input-error\");\n        DomHelper.ClearHTML(value + \"-error\");\n      });\n\n      Object.keys(data).forEach(function (value) {\n        DomHelper.AddClass(value, \"input-error\");\n        DomHelper.InnerHTML(value + \"-error\", data[value]);\n      });\n    }\n    else if (status == HttpHelper.OK) {\n\n      AlertFactory.GenerateSuccessAlert(container, data.message);\n      UrlHelper.Redirect(data.redirect_url, 1000);\n    }\n  }\n\n})(\n  DomHelper, AlertFactory, HttpHelper, UrlHelper,\n  this.LoginController = (\n    this.LoginController == undefined\n  ) ? {} : this.LoginController\n  );\n"]}